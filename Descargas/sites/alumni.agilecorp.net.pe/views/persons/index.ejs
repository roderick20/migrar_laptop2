<div class="col-12">
    <div class="card border rounded-3">
      <div class="card-header border-bottom p-3">
        <div class="d-sm-flex justify-content-between align-items-center">
          <h5 class="mb-2 mb-sm-0" style="font-size: 20px;">Personería</h5>
          <% if (role !== 1) { %>        
          <a class="btn btn-sm btn-primary" href="/persons/create" style="font-size: 15px;"> <i class="fa-solid fa-plus"></i> Agregar </a>
          <% } %>    
        </div>
      </div>
      <div class="card-body">
        <div class="table-responsive border-0" style="min-height:500px">
          <table id="listTable" class="table table-sm table-hover table-bordered">
            <thead>
              <tr>
                <th nowrap>
                  Nombres
                </th>
                <th>
                  Apellidos
                </th>
                <th>
                  Email
                </th>
                <th>
                  Photo
                </th>
                <th></th>
              </tr>
            </thead>
            
            <tbody>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
  <link href="/assets/vendor/datatables/datatables-1.13.1/css/datatables.bootstrap5.min.css" rel="stylesheet" />
  <script src="/assets/vendor/datatables/datatables-1.13.1/js/jquery.datatables.min.js"></script>
  <script src="/assets/vendor/datatables/datatables-1.13.1/js/datatables.bootstrap5.min.js"></script>
  <style>
    .dataTables_wrapper {
      font-size: 16px;
    }
  
    .form-select {
      font-size: 16px;
    }
  
    .page-link {
      font-size: 16px;
    }
  </style>
  
  <script>
    $(document).ready(function() {
      $('#listTable').dataTable({
        "language": {
          "url": "/assets/vendor/datatables/es-es.json"
        },
        search: {
          return: true
        },
        ordering: false,
        serverSide: true,
        processing: true,
        ajax: {
          url: '/persons/findalldt',
          type: 'POST'
        },
        columns: [{
            data: 'FirstName',
          },
          {
            data: 'LastName'
          },
          {
            data: 'Email'
          },
          {
            data: 'Photo',
            render: function(data, type, row) {
              const imageUrl = data ? `../uploads/${data}` : '../uploads/photo_person.png';
                return `<div class="dropdown">
                    <img src="${imageUrl}" style="width: 100px;" alt="Foto">
                    </div >`;
              },
          },
          {
            data: 'UniqueId',
            render: function(data, type, row) {
              return `<div class="dropdown">
                    <a class="btn btn-sm btn-primary" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-ellipsis-v fa-lg"></i></a>
                    <ul class="dropdown-menu dropdown-menu-end">
                      <li><a href="/persons/update/${data}" class="dropdown-item text-primary"><i class="fa-solid fa-pen-to-square"></i> Editar </a></li>
                      <li><a href="/persons/updatepassword/${data}" class="dropdown-item text-primary"><i class="fa-solid fa-key"></i> Cambiar Contraseña </a></li>
                      <% if (role !== 1) { %>              
                      <li><a href="/persons/delete/${data}" class="dropdown-item text-danger"><i class="fa-solid fa-trash"></i> Eliminar</a></li >
                      <% } %>     
                    </ul >
                  </div >`;
            },
            createdCell: function(td, cellData, rowData, row, col) {
              $(td).css("width", "1%");
            }
          }
        ]
      });
    });
  </script>
  