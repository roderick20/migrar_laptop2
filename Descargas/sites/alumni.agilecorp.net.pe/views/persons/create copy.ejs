<div class="col-12">
  <form id="formCreate" action="/persons/create" method="post" enctype="multipart/form-data">
    <div class="card border rounded-3">
      <div class="card-header  border-bottom p-3">
        <div class="d-sm-flex justify-content-between align-items-center">
          <h5 class="mb-2 mb-sm-0">Agregar Persona</h5>
        </div>
      </div>
      <div class="card-body">
        <div class="row">

          <% if (error !='' ) { %>
          <div class="text-danger">
            <%= error %>"
          </div>
          <% } else { %>
          <div class="col-md-4">
            <img id="previewImage" src="/assets/img/photo_person.png" class="img-fluid img-thumbnail" />
            <input type="file" name="inputFile" id="inputFile" style="display: none;">
          </div>
          <div class="col-md-8">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault" name="status">
              <label class="form-check-label" for="flexSwitchCheckDefault">Estado</label>
            </div>
            <div class="form-group">
              <label for="CompanyId" class="control-label">Área</label>
              <select name="CompanyId" id="CompanyId" class="form-select">
                <% companies.forEach(function(company) { %>
                <option value="<%= company.Id %>"><%= company.Name %></option>
                <% }); %>
              </select>
              <span for="CompanyId" class="text-danger"></span>
            </div>


            <div class="form-group">
              <label for="FirstName" class="control-label">Nombre</label>
              <input name="firstName" id="firstName" class="form-control" type="text" />
              <span for="FirstName" class="text-danger"></span>
            </div>
            <div class="form-group">
              <label for="LastName" class="control-label">Apellido</label>
              <input name="lastName" id="lastName" class="form-control" type="text" />
              <span for="LastName" class="text-danger"></span>
            </div>
            <div class="form-group">
              <label for="Email" class="control-label">Email</label>
              <input name="email" id="email" class="form-control" type="text" />
              <span for="Email" class="text-danger"></span>
            </div>
            <div class="form-group">
              <label for="Password" class="control-label">Password</label>
              <input name="password" id="password" class="form-control" type="text" />
              <span for="Password" class="text-danger"></span>
            </div>
            <div class="form-group">
              <label for="PhoneNumber" class="control-label">Celular</label>
              <input name="phoneNumber" id="phoneNumber" class="form-control" type="text" />
              <span for="PhoneNumber" class="text-danger"></span>
            </div>
          </div>
          <div class="col-md-12">
            <!-- <table class="table table-borderless">
              <tr>
                <td>
                  <div class="form-group">
                    <label for="Whatsapp" class="control-label">Whatsapp</label>
                    <input name="whatsapp" id="whatsapp" class="form-control" type="text" />
                    <span for="Whatsapp" class="text-danger"></span>
                  </div>
                </td>
                <td>
                  <div class="form-group">
                    <label for="Instagram" class="control-label">Instagram</label>
                    <input name="instagram" id="instagram" class="form-control" type="text" />
                    <span for="Instagram" class="text-danger"></span>
                  </div>
                </td>
                <td>
                  <div class="form-group">
                    <label for="Facebook" class="control-label">Facebook</label>
                    <input name="facebook" id="facebook" class="form-control" type="text" />
                    <span for="Facebook" class="text-danger"></span>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div class="form-group">
                    <label for="Youtube" class="control-label">Youtube</label>
                    <input name="youtube" id="youtube" class="form-control" type="text" />
                    <span for="Youtube" class="text-danger"></span>
                  </div>
                </td>
                <td>
                  <div class="form-group">
                    <label for="Telegram" class="control-label">Telegram</label>
                    <input name="telegram" id="telegram" class="form-control" type="text" />
                    <span for="Telegram" class="text-danger"></span>
                  </div>
                </td>
                <td>
                  <div class="form-group">
                    <label for="TikTok" class="control-label">TikTok</label>
                    <input name="tiktok" id="tiktok" class="form-control" type="text" />
                    <span for="TikTok" class="text-danger"></span>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div class="form-group">
                    <label for="Twitter" class="control-label">Twitter</label>
                    <input name="twitter" id="twitter" class="form-control" type="text" />
                    <span for="Twitter" class="text-danger"></span>
                  </div>
                </td>
                <td>
                  <div class="form-group">
                    <label for="Snapchat" class="control-label">Snapchat</label>
                    <input name="snapchat" id="snapchat" class="form-control" type="text" />
                    <span for="Snapchat" class="text-danger"></span>
                  </div>
                </td>
                <td>
                  <div class="form-group">
                    <label for="Spotify" class="control-label">Spotify</label>
                    <input name="spotify" id="spotify" class="form-control" type="text" />
                    <span for="Spotify" class="text-danger"></span>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div class="form-group">
                    <label for="Website" class="control-label">Sitio Web</label>
                    <input name="website" id="website" class="form-control" type="text" />
                    <span for="Website" class="text-danger"></span>
                  </div>
                </td>
                <td>
                  <div class="form-group">
                    <label for="Linkedin" class="control-label">Linkedin</label>
                    <input name="linkedin" id="linkedin" class="form-control" type="text" />
                    <span for="Linkedin" class="text-danger"></span>
                  </div>
                </td>
                <td>
                  <div class="form-group">
                    <label for="Paypal" class="control-label">Paypal</label>
                    <input name="paypal" id="paypal" class="form-control" type="text" />
                    <span for="Paypal" class="text-danger"></span>
                  </div>
                </td>
              </tr>
            </table> -->





            <!-- <div class="form-group">
                  <label for="FaceTime" class="control-label">FaceTime</label>
                  <input name="faceTime" id="faceTime" class="form-control" type="text" />
                  <span for="FaceTime" class="text-danger"></span>
                </div> -->
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <!-- <label for="CompanyId" class="control-label">Compañia</label>
                <input name="companyId" id="companyId" class="form-control" type="text" />
                <span for="CompanyId" class="text-danger"></span>
              </div> -->




              <!-- <div class="form-group">
                <label for="Role" class="control-label">Role</label>
                <select name="role" class="form-select" id="role">
                  <option value="1">uno</option>
                </select>
                <span for="Role" class="text-danger"></span>
              </div>
              <div class="form-group">
                <label for="DateOfBirth" class="control-label">Fecha de nacimiento</label>
                <input name="dateOfBirth" id="dateOfBirth" class="form-control" type="text" />
                <span for="DateOfBirth" class="text-danger"></span>
              </div> -->
              <!-- <div class="form-group">
                  <label for="Photo" class="control-label">Foto</label>
                  <input name="photo" id="photo" class="form-control" type="text" />
                  <span for="Photo" class="text-danger"></span>
                </div> -->
              <!-- <div class="form-group">
                <label for="Address" class="control-label">Dirección</label>
                <input name="address" id="address" class="form-control" type="text" />
                <span for="Address" class="text-danger"></span>
              </div> 
              <div class="form-group">
                <label for="LastAccess" class="control-label">Ultimo acceso</label>
                <input name="lastAccess" id="lastAccess" class="form-control" type="text" />
                <span for="LastAccess" class="text-danger"></span>
              </div>-->


              <!-- <div class="form-group">
                  <label for="Status" class="control-label">Estado</label>
                  <select name="status" class="form-select" id="status">
                    <option value="1">activo</option>
                    <option value="0">desactivo</option>
                  </select>
                  <span for="Status" class="text-danger"></span>
                </div> -->
            </div>
            <% } %>
          </div>
        </div>
        <div class="card-footer  border-bottom p-3">
          <div class="d-sm-flex justify-content-between align-items-center">
            <button class="btn btn-sm btn-info" href="/persons"><i class="fa-solid fa-arrow-left"></i> Regresar</button>
            <button class="btn btn-sm btn-primary" type="submit" id="btnSave"><i class="fa-solid fa-floppy-disk"></i>
              Agregar </button>
          </div>
        </div>
      </div>
  </form>
</div>

<!-- <script src="//cdnjs.cloudflare.com/ajax/libs/validate.js/0.13.1/validate.min.js"></script>

<link href="/assets/vendor/bootstrap-datepicker/css/bootstrap-datepicker.min.css" rel="stylesheet" />
<script src="/assets/vendor/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
<script src="/assets/vendor/bootstrap-datepicker/locales/bootstrap-datepicker.es.min.js"></script> -->

<script>
  const inputFile = document.getElementById('inputFile');
  const previewImage = document.getElementById('previewImage');

  previewImage.addEventListener('click', () => {
    inputFile.click();
  });


  inputFile.addEventListener('change', () => {
    if (inputFile.files && inputFile.files[0]) {
      const reader = new FileReader();
      reader.onload = function(e) {
        previewImage.src = e.target.result;
      };
      reader.readAsDataURL(inputFile.files[0]);
    }
  });



  // $('#dateOfBirth').datepicker({
  //   language: "es",
  //   format: "dd/mm/yyyy",
  //   autoclose: true,
  //   todayHighlight: true,
  //   orientation: "back"
  // });

  // $('#lastAccess').datepicker({
  //   language: "es",
  //   format: "dd/mm/yyyy ",
  //   autoclose: true,
  //   todayHighlight: true,
  //   orientation: "back"
  // });

  // var constraints = {
  //   name: {
  //     presence: {
  //       message: "El nombre es requerido"
  //     },
  //     length: {
  //       minimum: 3,
  //       message: "debe tener al menos 6 caracteres"
  //     }
  //   },
  //   lastName: {
  //     presence: {
  //       message: "El apellido es requerido"
  //     },
  //     length: {
  //       minimum: 3,
  //       message: "debe tener al menos 6 caracteres"
  //     }
  //   },
  //   email: {
  //     email: true,
  //     presence: {
  //       message: "El email es requerido"
  //     },

  //   },
  //   password: {
  //     presence: {
  //       message: "La contraseña es requerida"
  //     },
  //     length: {
  //       minimum: 6,
  //       message: "debe tener al menos 6 caracteres"
  //     }
  //   }
  // };

  const form = document.getElementById('formCreate');
  form.addEventListener('submit', function(event) {

    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    console.log(data);

    const errors = validate(data, constraints);
    console.log(errors);
    if (errors) {

      for (const field in errors) {
        const errorMessage = errors[field][0];
        const fieldElement = document.getElementById(field);
        fieldElement.classList.add('error');
        fieldElement.nextElementSibling.textContent = errorMessage;
      }
      event.preventDefault();
    } else {
      const btn = document.getElementById('btnSave');
      btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin-pulse"></i> Procesando';
      btn.disabled = true;
    }
  });
</script>