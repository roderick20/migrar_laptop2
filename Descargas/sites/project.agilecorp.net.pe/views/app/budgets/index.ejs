<div class="row">
  <div class="col-md-6 text-left">
    <h4>Presupuesto</h4>
  </div>
  <div class="col-md-6" style="text-align: right;">
    <a href="/budgets/create" class="btn btn-sm btn-primary"><i class="fa-solid fa-plus"></i> Agregar</a>
  </div>
</div>

<div class="row">
  <div class="col-md-6">

    <div class="card border rounded-3">
      <div class="card-body">
        <table id="tblList" class="table table-sm table-bordered  align-middle table-hover">
          <thead>
            <tr>
              <th>Gasto</th>
              <th>Tílulo</th>
              <th>Monto</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <% budgets.filter(m=> m.group != 'Ahorro' && m.group != 'Deudas').forEach((item) => { %>
              <tr>
                <td>
                  <%= item.group %>
                </td>
                <td>
                  <%= item.name %>
                </td>

                <td style="text-align: right;">
                  <%= parseFloat(item.money).toFixed(2) %>
                </td>
                <td style="width: 1%;" nowrap>
                  <a href="/budgets/update/<%= item._id.toString() %>"><i class="fa-solid fa-pen-to-square"></i></a>
                  <a href="/budgets/delete/<%= item._id.toString() %>" class="text-danger"
                    onclick="window.confirm('¿Deseas eliminar?') ? '' : event.preventDefault();"><i
                      class="fa-solid fa-trash"></i></a>
                </td>
              </tr>
              <% })%>
          </tbody>
        </table>
      </div>
    </div>

    <div class="card border rounded-3">
      <div class="card-body">
        <table id="tblList" class="table table-sm table-bordered  align-middle table-hover">
          <thead>
            <tr>
              <th>Deudas</th>
              <th>Tílulo</th>
              <th>Monto</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <% budgets.filter(m=> m.group == 'Deudas').forEach((item) => { %>
              <tr>
                <td>
                  <%= item.group %>
                </td>
                <td>
                  <%= item.name %>
                </td>

                <td style="text-align: right;">
                  <%= parseFloat(item.money).toFixed(2) %>
                </td>
                <td style="width: 1%;" nowrap>
                  <a href="/budgets/update/<%= item._id.toString() %>"><i class="fa-solid fa-pen-to-square"></i></a>
                  <a href="/budgets/delete/<%= item._id.toString() %>" class="text-danger"
                    onclick="window.confirm('¿Deseas eliminar?') ? '' : event.preventDefault();"><i
                      class="fa-solid fa-trash"></i></a>
                </td>
              </tr>
              <% })%>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="col-md-6">

    <div class="card border rounded-3">
      <div class="card-body">
        <table id="tblList" class="table table-sm table-bordered  align-middle table-hover">
          <thead>
            <tr>
              <th>Ahorro</th>
              <th>Tílulo</th>
              <th>Monto</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <% budgets.filter(m=> m.group == 'Ahorro').forEach((item) => { %>
              <tr>
                <td>
                  <%= item.group %>
                </td>
                <td>
                  <%= item.name %>
                </td>

                <td style="text-align: right;">
                  <%= parseFloat(item.money).toFixed(2) %>
                </td>
                <td style="width: 1%;" nowrap>
                  <a href="/budgets/update/<%= item._id.toString() %>"><i class="fa-solid fa-pen-to-square"></i></a>
                  <a href="/budgets/delete/<%= item._id.toString() %>" class="text-danger"
                    onclick="window.confirm('¿Deseas eliminar?') ? '' : event.preventDefault();"><i
                      class="fa-solid fa-trash"></i></a>
                </td>
              </tr>
              <% })%>
          </tbody>
        </table>
      </div>
    </div>

    <div class="card border rounded-3">
      <div class="card-body">

        <table class="table table-sm table-bordered  align-middle table-hover">
          <tr>
            <th>Ahorro</th>
            <td style="text-align: right;">
              <%= (budgets.filter(m=> m.group == 'Ahorro').reduce(function(acumulador, objeto) {
                return parseFloat(acumulador) + parseFloat((objeto.money || 0));
                }, 0)).toFixed(2) %>
            </td>
          </tr>
          <tr>
            <th>Gatos</th>
            <td style="text-align: right;">
              <%= (budgets.filter(m=> m.group != 'Ahorro' && m.group != 'Deudas').reduce(function(acumulador, objeto) {
                return parseFloat(acumulador) + parseFloat((objeto.money || 0));
                }, 0)).toFixed(2)%>
            </td>
          </tr>
          <tr>
            <th>Meses</th>
            <td style="text-align: right;">
              <%= (budgets.filter(m=> m.group == 'Ahorro').reduce(function(acumulador, objeto) {
                return parseFloat(acumulador) + parseFloat((objeto.money || 0));
                }, 0) /budgets.filter(m => m.group != 'Ahorro' && m.group != 'Deudas').reduce(function(acumulador,
                objeto) {
                return parseFloat(acumulador) + parseFloat((objeto.money || 0));
                }, 0)).toFixed(2)%>
            </td>
          </tr>
        </table>



      </div>
    </div>
  </div>
</div>